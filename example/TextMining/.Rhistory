title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_name(tag))
}
getContent(data$href[1])
x<- getContent(data$href[1])
x
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
getContent(data$href[1])
x<- getContent(data$href[1])
x
allText = sapply(data$href, getContent)
allText
write.table(allText, "mydata.txt")
attr(getContent(data$href[1]))
mode(getContent(data$href[1]))
allText_1<- strsplit(allText, "※ 發信站")
write.table(allText_1[1], "mydata.txt")
x<- write.table(allText_1[1], "mydata.txt")
allText_1
allText_1[1]
mode(allText_1)
allText_1[[1]]
allText_1[[1]][1]
allText_1[[1]][[1]
]
allText
allText_1<- strsplit(allText, "--")
allText_1
allText_1[, 1]
write.table(allText, "mydata.txt")
mydata.txt
View(getContent)
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
allText_1<- strsplit(allText, "--")
write.table(allText, "mydata.txt")
title
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
url<- paste0("https://www.ptt.cc", data$href[1])
html_text(read_html(url), 'div#main-content.bbs-screen.bbs-content')
data = data[-c(1:10),]
url<- paste0("https://www.ptt.cc", data$href[1])
html_text(read_html(url), 'div#main-content.bbs-screen.bbs-content')
html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
tag<- html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
toUTF8(html_text(tag))
allText_1<- strsplit(allText, "作者", "看板")
allText_1
regexpr(allText[1], "作者", "看板")
regexpr(allText[1], "作者")
regexpr(allText, "作者")
regexpr(allText[[1]], "作者")
?regexpr
source('pttTestFunction.R')
rm(list=ls(all.names = TRUE))
id<- c(1:10)
url_function<- function(x) {
URL   = paste0("https://www.ptt.cc/bbs/NTUcourse/index", 1994- x, ".html")
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
return(allText)
}
filename<- paste0(id, ".txt")
write.table(sapply(id, url_function), filename)
url_function(1)
url_function<- function(x)
URL   = paste0("https://www.ptt.cc/bbs/NTUcourse/index", 1994- x, ".html")
url_function<- function(x)paste0("https://www.ptt.cc/bbs/NTUcourse/index", 1994- x, ".html")
URL<- sapply(id, url_function)
html  = read_html(URL)
id<- c(1:10)
url_function<- function(x){
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", 1994- as.numeric(x), ".html")
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
}
sapply(id, url_function)
id<- c(1984:1993)
url_function<- function(x){
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index",x, ".html")
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
}
url_function(1)
url_function(1993)
source('pttTestFunction.R')
id = c(1:10)
URL = paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
filename = paste0(id, ".txt")
pttTestFunction(URL[1], filename[1])
mapply(pttTestFunction,
URL = URL, filename = filename)
source('pttTestFunction.R')
id = c(1:10)
URL = paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
filename = paste0(id, ".txt")
pttTestFunction(URL[1], filename[1])
mapply(pttTestFunction,
URL = URL, filename = filename)
library(tmcn)
library(rvest)
pttTestFunction <- function(URL, filename)
{
#URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
allText
#out <- file(filename, "w", encoding="BIG-5")
write.table(allText, filename)
#close(out)
}
source('pttTestFunction.R')
id = c(1:10)
URL = paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
filename = paste0(id, ".txt")
pttTestFunction(URL[1], filename[1])
mapply(pttTestFunction,
URL = URL, filename = filename)
pttTestFunction <- function(URL, filename)
{
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
allText
#out <- file(filename, "w", encoding="BIG-5")
write.table(allText, filename)
#close(out)
}
source('pttTestFunction.R')
id = c(1:10)
URL = paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
filename = paste0(id, ".txt")
pttTestFunction(URL[1], filename[1])
mapply(pttTestFunction,
URL = URL, filename = filename)
id<- c(1984:1993)
filename<- paste0(id-1984, ".txt")
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
url_function<- function(URL, filename){
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
sapply(id, url_function)
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
write.table(allText, filename)
}
mapply(url_function, URL= URL, filename= filename)
id<- c(1983:1992)
rm(list=ls(all.names = TRUE))
library(rvest)
id<- c(1983:1992)
filename<- paste0(id-1983, ".txt")
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
url_function<- function(URL, filename){
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
sapply(id, url_function)
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
write.table(allText, filename)
}
mapply(url_function, URL= URL, filename= filename)
url_function<- function(URL, filename){
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
sapply(id, url_function)
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
write.table(allText, filename)
}
url_function(URL[1], filename[1])
URL<-  "https://www.ptt.cc/bbs/NTUcourse/index"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
sapply(id, url_function)
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
URL<-  "https://www.ptt.cc/bbs/NTUcourse/index"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
URL<-  "https://www.ptt.cc/bbs/NTUcourse/index"
html  = read_html(URL)
title = html_nodes(html, "a")
c
c
library(tmcn)
rm(list=ls(all.names = TRUE))
library(rvest)
URL<-  "https://www.ptt.cc/bbs/NTUcourse/index"
html  = read_html(URL)
title = html_nodes(html, "a")
rm(list=ls(all.names = TRUE))
library(NLP)
library(tm)
library(jiebaRD)
library(jiebaR)
library(RColorBrewer)
library(NLP)
library(tm)
library(jiebaRD)
library(jiebaR)
library(RColorBrewer)
library(wordcloud)
library(wordcloud)
setwd("~/")
URL<-  "https://www.ptt.cc/bbs/NTUcourse/index"
html  = read_html(URL)
library(rvest)
library(tmcn)
library(rvest)
URL<-  "https://www.ptt.cc/bbs/NTUcourse/index"
html  = read_html(URL)
title = html_nodes(html, "a")
html  = read_html(URL)
title = html_nodes(html, "a")
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
url_function<- function(URL, filename){
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
}
q()
)
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
id<- c(1983:1992)
filename<- paste0(id, ".txt")
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
url_function<- function(URL, filename){
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
write.table(allText, filename)
}
mapply(url_function, URL= URL, filename= filename)
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
allText = sapply(data$href, getContent)
write.table(allText, filename)
library(tmcn)
rm(list=ls(all.names = TRUE))
library(rvest)
id<- c(1983:1992)
filename<- paste0(id, ".txt")
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
url_function<- function(URL, filename){
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
write.table(allText, filename)
}
mapply(url_function, URL= URL, filename= filename)
source('pttTestFunction.R')
setwd("D:/github/2017_data_course/example/TextMining")
source('pttTestFunction.R')
id = c(1:10)
URL = paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
filename = paste0(id, ".txt")
pttTestFunction(URL[1], filename[1])
mapply(pttTestFunction,
URL = URL, filename = filename)
mapply(pttTestFunction, URL = URL, filename = filename)
rm(list=ls(all.names = TRUE))
library(NLP)
library(tm)
library(jiebaRD)
library(jiebaR)
library(RColorBrewer)
library(wordcloud)
filenames <- list.files(getwd(), pattern="*.txt")
files <- lapply(filenames, readLines)
docs <- Corpus(VectorSource(files))
toSpace <- content_transformer(function(x, pattern) {
return (gsub(pattern, " ", x))
}
)
docs <- tm_map(docs, toSpace, "※")
docs <- tm_map(docs, toSpace, "◆")
docs <- tm_map(docs, toSpace, "‧")
docs <- tm_map(docs, toSpace, "的")
docs <- tm_map(docs, toSpace, "我")
docs <- tm_map(docs, toSpace, "是")
docs <- tm_map(docs, toSpace, "看板")
docs <- tm_map(docs, toSpace, "作者")
docs <- tm_map(docs, toSpace, "發信站")
docs <- tm_map(docs, toSpace, "批踢踢實業坊")
docs <- tm_map(docs, toSpace, "[a-zA-Z]")
docs <- tm_map(docs, removePunctuation)
docs <- tm_map(docs, removeNumbers)
docs <- tm_map(docs, stripWhitespace)
mixseg = worker()
jieba_tokenizer=function(d){
unlist(segment(d[[1]],mixseg))
}
seg = lapply(docs, jieba_tokenizer)
table(unlist(seg))
freqFrame = as.data.frame(table(unlist(seg)))
View(freqFrame)
freqFrame<- freqFrame[order(freqFrame$Freq, decreasing = T)]
#文字雲
#出現頻率大於50，只選擇150個詞
wordcloud(freqFrame$Var1,freqFrame$Freq,
scale=c(5,0.1),min.freq=50,max.words=150,
random.order=TRUE, random.color=FALSE,
rot.per=.1, colors=brewer.pal(8, "Dark2"),
ordered.colors=FALSE,use.r.layout=FALSE,
fixed.asp=TRUE)
?order
freqFrame<- freqFrame[order(freqFrame$Freq, decreasing = TRUE)]
freqFrame<- freqFrame[order(freqFrame$Freq)]
freqFrame = as.data.frame(table(unlist(seg)))
View(freqFrame)
freqFrame<- freqFrame[order(freqFrame$Freq, decreasing = TRUE), ]
head(freq)
head(freqFrame)
wordcloud(freqFrame$Var1,freqFrame$Freq,
scale=c(5,0.1),min.freq=50,max.words=150,
random.order=TRUE, random.color=FALSE,
rot.per=.1, colors=brewer.pal(8, "Dark2"),
ordered.colors=FALSE,use.r.layout=FALSE,
fixed.asp=TRUE)
library(tmcn)
rm(list=ls(all.names = TRUE))
library(rvest)
#install.packages("tmcn",
#repos="http://R-Forge.R-project.org")
id<- c(1983:1992)
filename<- paste0(id, ".txt")
URL<- paste0("https://www.ptt.cc/bbs/NTUcourse/index", id, ".html")
url_function<- function(URL, filename){
URL   = "https://www.ptt.cc/bbs/NTUcourse/index.html"
html  = read_html(URL)
title = html_nodes(html, "a")
href  = html_attr(title, "href")
data = data.frame(title = toUTF8(html_text(title)),
href = href)
data = data[-c(1:10),]
getContent <- function(x) {
url  = paste0("https://www.ptt.cc", x)
tag  = html_node(read_html(url), 'div#main-content.bbs-screen.bbs-content')
text = toUTF8(html_text(tag))
}
#getContent(data$href[1])
allText = sapply(data$href, getContent)
write.table(allText, filename)
}
mapply(url_function, URL= URL, filename= filename)
